(function($) {

    let $title, $testimonial, $read_more, $reviewer_name, $designation, $company_name, $company_email, $company_phone;

    const selectors = {
        title: '.box-tm-title',
        testimonial: '.gs_tstm_area .box-content',
        read_more: '.box-content .gstm-popup--link',
        reviewer_name: '.box-client-name',
        designation: '.box-desiginfo .box-design-name',
        company_name: '.box-companyinfo .box-company-name',
        company_email: '.gs-tai-client .gs-tai-email',
        company_phone: '.gs-tai-client .gs-tai-contact .gstm-phone',
    };

    const maybe_load_font = function (font) {
        if (!font) return;
        const font_url = `https://fonts.googleapis.com/css2?family=${font.replace(/ /g, '+')}&display=swap`;
        if (!$(`link[href="${font_url}"]`).length) {
            $('head').append(`<link href="${font_url}" rel="stylesheet" />`);
        }
    };

    const get_typography_style = function ( settings ) {

        let style = '';

        if ( settings.color ) style += `color: ${settings.color} !important;`;
        // if ( settings.hoverColor ) style += `color: ${settings.hoverColor} !important;`;

        if ( settings.fontFamily ) {
            style += `font-family: ${settings.fontFamily} !important;`;
            maybe_load_font( settings.fontFamily );
        }
        if ( settings.size ) style += `font-size: ${settings.size}px !important;`;
        if ( settings.style ) style += `font-style: ${settings.style} !important;`;
        if ( settings.weight ) style += `font-weight: ${settings.weight} !important;`;
        if ( settings.lineHeight ) style += `line-height: ${settings.lineHeight} !important;`;
        if ( settings.letterSpacing ) style += `letter-spacing: ${settings.letterSpacing}px !important;`;
        if ( settings.transform ) style += `text-transform: ${settings.transform} !important;`;
        if ( settings.decoration ) style += `text-decoration: ${settings.decoration} !important;`;

        return style;
    }

    const typography_title = function ( data ) {

        if ( ! $title ) $title = $(selectors.title);

        if ( ! $title.length ) return;

        if ( $title && $title.length ) {
            
            $('#gs-testimonials--typography_title_style').remove();

            let style = get_typography_style( data );
            
            if ( style ) {
                style = `<style id="gs-testimonials--typography_title_style">body .gs_testimonial_container .box-tm-title, body .gstm_popup_details .box-tm-title { ${style} }</style>`;
                $('head').append( style );
            }

        }

    }

    const typography_testimonial = function ( data ) {

        if ( ! $testimonial ) $testimonial = $(selectors.testimonial);

        if ( ! $testimonial.length ) return;

        if ( $testimonial && $testimonial.length ) {

            $('#gs-testimonials--typography_testimonial_style').remove();

            let style = get_typography_style( data );

            if ( style ) {
                style = `<style id="gs-testimonials--typography_testimonial_style">body .gs_tstm_area .box-content, body .gstm_popup_details .box-content { ${style} }</style>`;
                $('head').append( style );
            }

        }

    }

    const typography_read_more = function ( data ) {

        if ( ! $read_more ) $read_more = $(selectors.read_more);

        if ( ! $read_more.length ) return;

        if ( $read_more && $read_more.length ) {

            $('#gs-testimonials--typography_read_more_style').remove();

            let style = get_typography_style( data );

            if ( style ) {
                style = `<style id="gs-testimonials--typography_read_more_style">body .gs_testimonial_container .box-content .gstm-popup--link { ${style} }</style>`;
                $('head').append( style );
            }

        }

    }

    const typography_reviewer_name = function ( data ) {

        if ( ! $reviewer_name ) $reviewer_name = $(selectors.reviewer_name);

        if ( ! $reviewer_name.length ) return;

        if ( $reviewer_name && $reviewer_name.length ) {

            $('#gs-testimonials--typography_reviewer_name_style').remove();

            let style = get_typography_style( data );

            if ( style ) {
                style = `<style id="gs-testimonials--typography_reviewer_name_style">body .gs_testimonial_container .box-client-name, body .gstm_popup_details .gstm-popup--content-area .reviewer-name { ${style} }</style>`;
                $('head').append( style );
            }

        }

    }

    const typography_designation = function ( data ) {

        if ( ! $designation ) $designation = $(selectors.designation);

        if ( ! $designation.length ) return;

        if ( $designation && $designation.length ) {

            $('#gs-testimonials--typography_designation_style').remove();

            let style = get_typography_style( data );

            if ( style ) {
                style = `<style id="gs-testimonials--typography_designation_style">body .gs_testimonial_container .box-desiginfo .box-design-name, body .gstm_popup_details .gstm-popup--content-area .reviewer-designation { ${style} }</style>`;
                $('head').append( style );
            }

        }

    }

    const typography_company_name = function ( data ) {

        if ( ! $company_name ) $company_name = $(selectors.company_name);

        if ( ! $company_name.length ) return;

        if ( $company_name && $company_name.length ) {

            $('#gs-testimonials--typography_company_name_style').remove();

            let style = get_typography_style( data );

            if ( style ) {
                style = `<style id="gs-testimonials--typography_company_name_style">body .gs_testimonial_container .box-companyinfo .box-company-name, body .gstm_popup_details .gstm-popup--content-area .reviewer-company .reviewer-company-name { ${style} }</style>`;
                $('head').append( style );
            }

        }

    }

    const typography_company_email = function ( data ) {

        if ( ! $company_email ) $company_email = $(selectors.company_email);

        if ( ! $company_email.length ) return;
        if ( $company_email && $company_email.length ) {

            $('#gs-testimonials--typography_company_email_style').remove();

            let style = get_typography_style( data );

            if ( style ) {
                style = `<style id="gs-testimonials--typography_company_email_style">body .gs_testimonial_container .gs-tai-email a, body .gstm_popup_details .gstm-popup--content-area .gs-tai-email a { ${style} }</style>`;
                $('head').append( style );
            }

        }

    }

    const typography_company_phone = function ( data ) {

        if ( ! $company_phone ) $company_phone = $(selectors.company_phone);

        if ( ! $company_phone.length ) return;
        if ( $company_phone && $company_phone.length ) {

            $('#gs-testimonials--typography_company_phone_style').remove();

            let style = get_typography_style( data );

            if ( style ) {
                style = `<style id="gs-testimonials--typography_company_phone_style">body .gs_testimonial_container .gs-tai-client .gs-tai-contact .gstm-phone , body .gstm_popup_details .gstm-popup--content-area .reviewer-company-phone .gstm-phone { ${style} }</style>`;
                $('head').append( style );
            }
        }
    }


	window.addEventListener( 'message', event => {

		let data = event.data;

		if ( data.typography_title ) typography_title( data.typography_title );
		if ( data.typography_testimonial ) typography_testimonial( data.typography_testimonial );
		if ( data.typography_read_more ) typography_read_more( data.typography_read_more );
		if ( data.typography_reviewer_name ) typography_reviewer_name( data.typography_reviewer_name );
		if ( data.typography_designation ) typography_designation( data.typography_designation );
        if ( data.typography_company_name ) typography_company_name( data.typography_company_name );
        if ( data.typography_company_email ) typography_company_email( data.typography_company_email );
        if ( data.typography_company_phone ) typography_company_phone( data.typography_company_phone );
	});

})(jQuery);